# 📋 要件定義 — Lobster Desktop Widget

## 🎯 ゴール

Pixoo-64電光掲示板のデスクトップ版ウィジェットを作る。
デスクトップなら解像度制約なし→最大8匹のロブスターを同時表示。

## ✅ 必須要件 (MUST)

### 表示
1. **透過背景ウィンドウ** — デスクトップに溶け込む、枠なし
2. **常に最前面** — 他のウィンドウの上に表示
3. **ドラッグ移動** — ウィジェットをマウスで移動可能
4. **リサイズ可能** — 最小200x100〜最大800x400
5. **最大8匹同時表示** — 横並び or グリッド配置

### ロブスター表示
6. **4フレームアニメーション** — 各キャラ250ms/フレーム（Pixoo準拠）
7. **7キャラ + スリープ** — opus/sonnet/haiku/gemini/kusomegane/codex/grok/sleep
8. **スプライト画像** — 既存の64x64 PNGフレームを流用
9. **キャラ切替** — サブエージェント登録/完了で動的に増減

### 情報表示
10. **個別タイマー** — 各エージェントの経過時間、虹色サイクリング
11. **カウント表示** — 稼働中エージェント数（1=緑→7=赤）
12. **スクロールテキスト** — 最新タスク名 or 最優先タスク
13. **スリープモード** — 10分アイドルでスリープアニメ

### データ連携
14. **`/tmp/pixoo-agents.json`** 監視（1秒ポーリング）
15. **`todo-priority.md`** 読み込み（60秒ポーリング）

## 🟡 推奨要件 (SHOULD)

16. **システムトレイアイコン** — 最小化時トレイに格納
17. **右クリックメニュー** — 終了/設定/配置変更
18. **設定永続化** — ウィンドウ位置・サイズを記憶
19. **起動時自動実行** — Windows スタートアップ登録オプション
20. **サウンド通知** — 新サブエージェント追加時にピコン♪（オプション）

## 🔵 あったら嬉しい (COULD)

21. **エージェントにホバー** — マウスオーバーでタスク詳細ポップアップ
22. **クリックで詳細** — エージェントクリックでOpenClaw画面に飛ぶ
23. **ダークモード/ライトモード** — テーマ切替
24. **カスタムスプライト** — ユーザーが独自キャラ画像を追加可能

## 🛠️ 技術スタック候補

### 案1: Electron（推奨）
- **Pro**: HTML/CSS/JS、リッチUI、透過ウィンドウ、クロスプラットフォーム
- **Con**: メモリ使用量（100-200MB）、起動時間
- **判断**: デスクトップウィジェットとしては重いが最も機能豊富

### 案2: Tauri
- **Pro**: Rust+WebView、Electronの1/10のサイズ、軽量
- **Con**: Rust必要、WebView2依存（Windows 10+はプリインストール）
- **判断**: 軽量で良いが、Rustのセットアップコストあり

### 案3: PyQt / tkinter
- **Pro**: Python（既存スクリプトと親和性高い）、軽量
- **Con**: UI表現力が低い、透過背景が難しい
- **判断**: 機能的に不足する可能性

### 案4: Web Only (HTML+CSS+JS)
- **Pro**: 最もシンプル、ゼロ依存、ブラウザで開くだけ
- **Con**: 常駐ウィジェットにならない（ブラウザの一タブ）
- **判断**: プロトタイプとしては最適、本番は別ソリューション

**→ サブエージェントのリサーチ結果で最終決定**

## 📐 レイアウト設計

```
┌──────────────────────────────────────────┐
│ 🦞  🔵  🟢  🟡  🟣  😎  ⚡  💤   x3 │  ← ロブスター列（最大8匹）
│ 0:35 1:12 0:45                          │  ← 個別タイマー
│ ▶ [sonnet] メモ修正原因分析...          │  ← スクロールテキスト
└──────────────────────────────────────────┘
```

## 📁 ディレクトリ構成（想定）

```
lobster-desktop-widget/
├── README.md
├── docs/
│   └── REQUIREMENTS.md
├── assets/
│   └── sprites/          # 64x64 PNG frames (copied from /tmp/)
│       ├── opus-frame1.png
│       ├── opus-frame2.png
│       ├── ...
│       └── sleep-frame4.png
├── src/                  # アプリケーションソース
├── package.json          # (Electron/Tauri の場合)
└── ...
```

## 🔄 開発フロー

1. **リサーチ** — 技術スタック最終決定（サブエージェント）
2. **プロトタイプ** — 1匹のロブスターを透過ウィンドウで表示
3. **マルチ表示** — 8匹同時、動的増減
4. **データ連携** — pixoo-agents.json + todo-priority.md
5. **UI仕上げ** — タイマー、カウント、スクロールテキスト
6. **パッケージング** — インストーラー、自動起動
